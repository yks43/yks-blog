# Spring介绍
## Spring是什么

## 解决了什么问题

# IOC
## 是什么
> 依赖注入，控制反转；Spring IOC 解决的是对象管理和对象依赖的问题。本来我们的对象都是new出来的，而我们如果使用Spring 则把对象交给「IOC容器」来管理。

### IOC容器
> 是一个「工厂」，我们把对象都交由这个「工厂」来管理，包括对象的创建和对象之间的依赖关系等等。等我们要用到对象的时候，就从这个「工厂」里边取出来。

### 控制反转
> 本来是「由我们自己」new出来的对象，现在交给了IOC容器。把这个对象的「控制权」给「他方」了。「控制反转」更多的是一种思想或者说是设计模式，把原有由自己掌控的事交给「别人」来处理。

### 依赖注入
> 「依赖注入」更多指的是「控制反转」这个思想的实现方式：对象无需自行创建或管理它们的依赖关系，依赖关系将被「自动注入」到需要它们的对象当中去。

理解：本来我们的对象都是「由我们自己」new出来的，现在我们把这个对象的创建权限和对象之间的依赖关系交由「IOC容器」来管理。

## 优点
* 将对象集中统一管理，便于修改
* 降低耦合度（调用方无需自己组装，也无需关心对象的实现，直接从「IOC容器」取就好了）

## IOC需要学什么

### 将对象交给IOC容器
Spring提供了四种方式：
* 注解
* XML
* JavaConfig
* 基于Groovy DSL配置

以XML配置+注解来装配Bean比较多，其中注解这种方式占大部分。

### 告诉IOC容器bean之间的依赖关系（依赖注入）

依赖关系：日常开发中其实很多时候就是A对象里边有B对象的属性而已。

**方式：**
* 构造器
* 属性（setting方法）

### 举个栗子
日常开发中，我们很多时候用@Component注解标识将对象放到「IOC容器」中，用@Autowired注解将对象注入

下面这张图就很好总结了以各种方式来对Bean的定义和注入。
![](../images/bean的定义和注入.jpg)

# AOP
## 是什么
AOP：Aspect Object Programming  「面向切面编程」
Spring AOP主要做的事情就是：「把重复的代码抽取，在运行的时候往业务方法上动态植入“切面类代码”」
**底层技术：动态代理**



# 事务

## 理解
> Spring事务管理用的是AOP，AOP底层用的是动态代理。所以如果我们在类或者方法上标注注解@Transactional，那么会生成一个代理对象。

## 可能出现的情况
### 第一种
在Service层抛出Exception，在Controller层捕获，那如果在Service中有异常，那会事务回滚吗？

如果是编译时异常不会自动回滚，如果是运行时异常，那会自动回滚！
### 第二种
带有@Transactional注解所包围的方法就能被Spring事务管理起来，那如果我在当前类下使用一个没有事务的方法去调用一个有事务的方法，那我们这次调用会怎么样？是否会有事务呢？




## 事务传播机制
> 在当前含有事务方法内部调用其他的方法(无论该方法是否含有事务)，这就属于Spring事务传播机制的知识点范畴了。

Spring事务基于Spring AOP，Spring AOP底层用的动态代理，动态代理有两种方式：

* 基于接口代理(JDK代理)
  * 基于接口代理，凡是类的方法非public修饰，或者用了static关键字修饰，那这些方法都不能被Spring AOP增强
* 基于CGLib代理(子类代理)
  * 基于子类代理，凡是类的方法使用了private、static、final修饰，那这些方法都不能被Spring AOP增强

